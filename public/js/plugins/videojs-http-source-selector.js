!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e=e||self)["videojs-http-source-selector"]=t(e.videojs)}(this,function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function o(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e=e&&e.hasOwnProperty("default")?e.default:e;var n=e.getComponent("MenuItem"),l=e.getComponent("Component"),i=function(e){function o(t,o){return o.selectable=!0,o.multiSelectable=!1,e.call(this,t,o)||this}t(o,e);var n=o.prototype;return n.handleClick=function t(){var o=this.options_;console.log("Changing quality to:",o.label),e.prototype.handleClick.call(this);for(var n=this.player().qualityLevels(),l=0;l<n.length;l++)o.index==n.length?n[l].enabled=!0:o.index==l?n[l].enabled=!0:n[l].enabled=!1},n.update=function e(){var t=this.player().qualityLevels().selectedIndex;this.selected(this.options_.index==t)},o}(n);l.registerComponent("SourceMenuItem",i);var r=e.getComponent("MenuButton"),s=function(n){function l(t,l){i=n.call(this,t,l)||this,r.apply(o(i),arguments);var i,s=i.player().qualityLevels();if(l&&l.default){if("low"==l.default)for(var a=0;a<s.length;a++)s[a].enabled=0==a;else{l.default="high";for(var a=0;a<s.length;a++)s[a].enabled=a==s.length-1}}return i.player().qualityLevels().on(["change","addqualitylevel"],e.bind(o(i),i.update)),i}t(l,n);var s=l.prototype;return s.createEl=function t(){return e.dom.createEl("div",{className:"vjs-http-source-selector vjs-menu-button vjs-menu-button-popup vjs-control vjs-button"})},s.buildCSSClass=function e(){return r.prototype.buildCSSClass.call(this)+" vjs-icon-cog"},s.update=function e(){return r.prototype.update.call(this)},s.createItems=function e(){for(var t=[],o=this.player().qualityLevels(),n=[],l=0;l<o.length;l++){var r=o.length-(l+1),s=r===o.selectedIndex,a=""+r,u=r;o[r].height?(a=o[r].height+"p",u=parseInt(o[r].height,10)):o[r].bitrate&&(a=Math.floor(o[r].bitrate/1e3)+" kbps",u=parseInt(o[r].bitrate,10)),!(n.indexOf(a)>=0)&&(n.push(a),t.push(new i(this.player_,{label:a,index:r,selected:s,sortVal:u})))}return o.length>1&&t.push(new i(this.player_,{label:"Auto",index:o.length,selected:!1,sortVal:99999})),t.sort(function(e,t){return e.options_.sortVal<t.options_.sortVal?1:e.options_.sortVal>t.options_.sortVal?-1:0}),t},l}(r),a={},u=e.registerPlugin||e.plugin,c=function t(o,n){if(o.addClass("vjs-http-source-selector"),console.log("videojs-http-source-selector initialized!"),console.log("player.techName_:"+o.techName_),"Html5"!=o.techName_)return!1;o.on(["loadedmetadata"],function(t){if(o.qualityLevels(),e.log("loadmetadata event"),"undefined"==o.videojs_http_source_selector_initialized||!0==o.videojs_http_source_selector_initialized)console.log("player.videojs_http_source_selector_initialized == true");else{console.log("player.videojs_http_source_selector_initialized == false"),o.videojs_http_source_selector_initialized=!0;var n=o.controlBar,l=n.getChild("fullscreenToggle").el();n.el().insertBefore(n.addChild("SourceMenuButton").el(),l)}})},d=function t(o){var n=this;this.ready(function(){c(n,e.mergeOptions(a,o))}),e.registerComponent("SourceMenuButton",s),e.registerComponent("SourceMenuItem",i)};return u("httpSourceSelector",d),d.VERSION="1.1.5",d});